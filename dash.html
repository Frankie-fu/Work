<html>

  <head>
    <title>Dashboard</title>
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src='https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js'></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>

    <style>
      .card{
        height:500px;
      }
    </style>
  </head>

  <body>
    <nav>
      <div class="nav-wrapper red darken-2 white-text">
        <a href="#" class="brand-logo" style='padding-left:10px;'>Dashboard</a>
        <ul id="nav-mobile" class="right hide-on-med-and-down">
          <li><a href="sass.html">Sass</a></li>
          <li><a href="badges.html">Components</a></li>
          <li><a href="collapsible.html">JavaScript</a></li>
        </ul>
      </div>
    </nav>

    <div class="row">
      <div class="col s12 m6">
        <div class="card">
          <div class="card-content">
            <span class="card-title">Top 10 COVID Death</span>
            <div id = 'output'></div>
          </div>
        </div>
      </div> <!-- end of column -->
    <div> <!-- end of 1st row-->
    <div class="row">
      <div class="col s12 m6">
        <div class="card">
          <div class="card-content">
            <span class="card-title">Map</span>
            <div id='map' style="width:100%; height:63%;"></div>
          </div>
        </div>
      </div> <!-- end of column -->
    <div> <!-- end of 2nd row -->
      <div class="row">
        <div class="col s12 m6">
          <div class="card">
            <div class="card-content">
              <span class="card-title">Map</span>
              <div id='map'></div>
            </div>
          </div>
        </div> <!-- end of column -->
      <div> <!-- end of 3rd row -->
        <div class="row">
          <div class="col s12 m6">
            <div class="card">
              <div class="card-content">
                <span class="card-title">Map</span>
                <div id='map'></div>
              </div>
            </div>
          </div> <!-- end of column -->
        <div> <!-- end of 4th row -->

  </body>

  <script>

    axios.get('https://www.trackcorona.live/api/countries')
      .then(response => {
        buildList(response.data.data);
      })

    mapIt();

    function mapIt(){
      var map = L.map('map').setView([31.2304, 121.4737], 15);

      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
      }).addTo(map);

      L.marker([31.2304, 121.4737]).addTo(map)
        .bindPopup("<h6>Shanghai, China.</h6><br> <img src='https://tse1-mm.cn.bing.net/th/id/OIP-C.uVDU4tWc0-3osTYKNYLdaQHaE7?pid=ImgDet&rs=1' style='width:150px'>")
        .openPopup();

    }

    function buildList(data){
      var dHandle = document.getElementById('output');
      var myHTML = "<ul class = 'collection'>";

      data.sort(function (a,b) {
        return b.dead - a.dead;
      });

      for (i=0;i<10;i++){
        myHTML = myHTML + "<li class='collection-item'>" + data[i].location + "-" + data[i].dead + "</li>"
      }
      myHTML = myHTML + "</ul>"
      dHandle.innerHTML = myHTML;
    }
  </script>

</html>
